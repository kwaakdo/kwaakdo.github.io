---
title: 한셀 VBS로 업무 자동화하기
tags: VBS excel
---
한셀은 [한컴오피스](https://www.hancom.com/cs_center/csDownload.do)에서 만든 스프레드시트이다. 마이크로소프트의 엑셀과 비슷한 것 같으면서도 다르다. 웹 사이트나 서적을 확인해보면 보통 엑셀 VBA에 대해 다루고 한셀의 VBS는 다루지 않는다. 그렇다고 엑셀 VBA책을 사자니 문법이 미세하게 다르므로 오류가 발생하기 때문에 입문하기가 쉽지 않다. 진입장벽이나 호환성, 기능 문제 등으로 한셀을 사용하는 것을 권장하지 않는다. 군부대의 인트라넷처럼 어쩔수 없이 사용해야 하는 경우를 제외하면 말이다.
<!--more-->
# 한셀 VBS에 대하여
한셀 VBS는 같은 스프레드시트 소프트웨어인 엑셀 VBA와 비교될 수 밖에 없다. 우선 장단점에 대해 살펴보도록 하자.
---

## 장점
1. 한글로 된 변수나 프로시저를 지원한다. 가끔 충돌을 유발하므로 권장하지 않는다. 
2. 가격이 저렴하다. 그래서 공기업이나 군부대에 보급이 많이 된다.

## 단점
### 사용자 정의 폼 미지원
엑셀에서 강력하다고 생각하는 [사용자 정의 폼](https://www.excel-easy.com/vba/userform.html)기능이 한셀에는 없다. 이 기능을 활용할 수 있으면 수많은 응용이 가능해지는데, 이게 생산성을 증폭시켜준다고 생각한다. 아무래도 사용자 정의 폼 이라는게 엑셀의 비주얼 베이직 기반이다보니 한컴오피스 입장에서는 애매했을수도 있다.
### 디버깅 미지원
한셀은 디버깅이 안된다. 아무 기능도 없고 MsgBox등을 활용해 직접 확인해보는 수 밖에 없다. 이쯤되면 왜 군대나 여타 공기업에서만 한셀을 사용하는지 알 법하다. 유일한 장점인 가격때문이다. 참고로, 엑셀에서는 `한 줄씩 실행` 또는 `프로시저 단위 실행`도 있고, `중단점 지정`도 지원한다.
### 워크북, 워크시트 이벤트 미흡
엑셀에는 이벤트라는게 있다. 예를들어 `Workbooks.Open`은 엑셀파일이 실행됬을 때 작동하는 이벤트이다. 특정 셀을 더블클릭하거나 우클릭하거나 이벤트를 발생 시킬 수 있는데 한셀에서는 이게 제한적이다. 키보드 입력 이벤트는 보안상의 이유인지 아얘 막혀있고, `Workbooks.Open`도 작동하지 않는다.
### 에디터 자체의 기능 부족
찾아 바꾸기, 자동 완성 기능이 없다. 그래서 노트패드 ++ 같은 다른 소프트웨어를 활용해야한다. 그리고 최적화가 잘 안되어 있어서 코드가 몇 백, 몇 천줄로 길어지게 될 경우 많이 느려진다. 
### 여러가지 기능 오류
겪어보았던 오류만 해도 수십가지가 된다. 한셀 2018 NEO 버전으로 들어오면서 더 그렇다. 자주 겪었던 문제를 나열해보자면 이렇다.

1. 매크로 기록시 모듈이 생성되는데, 삭제할 수 없음.
2. VBS 상에서 다른 엑셀파일 참조 시 켜져있는 엑셀파일과 의도치않은 충돌이 발생함.
3. 가끔 `Cells(3, "A"+변수)` 와 같이 한글 이름으로 된 변수를 연산에 사용하면 에러가 나옴.
4. 논리상 무한 루프나 수많은 연산이 나올 경우 다운됨.
5. 2018부터 셀의 하이퍼링크 참조가 안됨. 도형으로 대체하여 개발하여야 한다.

---
<div class="hero hero--dark" style="background-color: #123;">
  <div class="hero__content">
    <h3>한셀 VBA 튜토리얼</h3>
  </div>
</div>
# 한셀 VBS 기초
위와 같은 무수한 단점이 있더라도 우회를 통하여 어느정도 원하는 한셀 프로그램을 개발할 수 있다. 물론 우회를 하려면 한셀에 존재하는 오류들을 어느정도 인지해야하고 그러기 위해서는 개발을 많이 해보는 수 밖에 없다. 이제부터 한셀 VBS에 대해 다루도록 하겠다.

## 한셀의 변수 선언
``` vb
Dim 변수명
```
한셀은 위와같이 `Dim`으로 변수를 지정해준다. 엑셀은 `Dim 변수명 As Range`와 같이 변수형을 지정해 줄 수 있는데 한셀은 이런식으로 변수형을 지정해주면 에러가 난다.

## 한셀의 조건문

### If 문
``` vb
If 조건 Then
	[코드]
End If
```

### For 문

### For Each 문

### Select Case 문
